import{j as e,r as y,a as re}from"./react-DSroWhVQ.js";import{c as te}from"./react-dom-CkgdwS5A.js";import{u as F,a as K,b as E,Q as ne,c as oe}from"./react-query-CQ6KV6VS.js";import{L as k,c as ae,R as ie}from"./react-router-dom-Clon78nL.js";import{s as le,M as q,A as Q,F as p,I as N,T as v,a as V,B as C,D as ce,C as J,b as de,c as ue,d as O,e as me}from"./antd-D0HcZuKM.js";import{u as S,C as f}from"./react-hook-form-XW8Slzei.js";import{o as R}from"./@hookform-DZr9R--c.js";import{c as M,a as b,b as w}from"./yup-DyMOu5Ms.js";import{a as he}from"./axios-CCb-kr4I.js";import{M as G,F as Y,B as pe}from"./react-icons-VfhUKtYt.js";import{A as xe,M as je}from"./@vis.gl-BqbVdpYv.js";import{c as W,O as fe,f as z}from"./react-router-Cq2-_Huq.js";import{N as ge}from"./@ant-design-D0dvLJ_u.js";var ye={};const U=ye.REACT_APP_TOKEN_KEY||"",_e=s=>{sessionStorage.setItem(U,JSON.stringify({id:s}))},X=()=>{const s=sessionStorage.getItem(U);if(!s)return null;const{id:r}=JSON.parse(s);return r},be=()=>{sessionStorage.removeItem(U),sessionStorage.clear()},Ne=(s,r)=>{sessionStorage.setItem("username",s),sessionStorage.setItem("role",r)},ve=()=>sessionStorage.getItem("role");var Ce={};const Fe=Ce.REACT_APP_BACKEND_URL_API,D=he.create({baseURL:Fe,headers:{Authorization:`Bearer ${X()}`}}),Ae=s=>{D.defaults.headers.common.Authorization=`Bearer ${s}`},P=async(s,r,t={})=>(t!=null&&t.headers||(t.headers={}),t.headers["Content-Type"]="application/json",D.post(s,JSON.stringify(r),t)),Z=async(s,r={})=>D.get(s,r),ee=async(s,r={})=>(r!=null&&r.headers||(r.headers={}),r.headers["Content-Type"]="application/json",D.delete(s,r)),we=async(s,r,t={})=>(t!=null&&t.headers||(t.headers={}),t.headers["Content-Type"]="application/json",D.patch(s,JSON.stringify(r),t)),qe=s=>{const{data:r,isSuccess:t,isLoading:o}=K({queryKey:["get-apartments"],queryFn:()=>Z("apartment/list",{params:s})});return{data:r,isSuccess:t,isLoading:o}},Se=({onSuccess:s,onError:r})=>{const{mutate:t,isError:o,isLoading:a,isSuccess:n,data:l}=F({mutationFn:i=>P("apartment/new",i),onSuccess:s,onError:r});return{mutate:t,isError:o,isLoading:a,isSuccess:n,data:l}},Ie=({onSuccess:s,onError:r})=>{const{mutate:t,isError:o,isLoading:a,isSuccess:n,data:l}=F({mutationFn:i=>we(`apartment/${i.id}`,i),onSuccess:s,onError:r});return{mutate:t,isError:o,isLoading:a,isSuccess:n,data:l}},ke=({onSuccess:s,onError:r})=>{const{mutate:t,isError:o,isLoading:a,isSuccess:n,data:l}=F({mutationFn:i=>ee(`apartment/${i}`),onSuccess:s,onError:r});return{mutate:t,isError:o,isLoading:a,isSuccess:n,data:l}},A=()=>{const[s,r]=le.useNotification();return{openNotification:(o,a)=>{s.open({type:a,message:"Notification",description:o,placement:"topRight"})},contextHolder:r}};function Te({onCancel:s,isModalOpen:r,title:t,currentRowId:o}){const a=E(),{openNotification:n,contextHolder:l}=A(),{mutate:i}=ke({onSuccess:()=>{n("Deleted Apartment successfully","success"),s(),a.invalidateQueries("get-apartments")},onError:()=>{n("Failed to deleted the Apartment!","error")}}),h=()=>{i(o)};return e.jsxs(e.Fragment,{children:[e.jsx(q,{title:t,style:{height:300},open:r,onOk:h,onCancel:s,children:e.jsx(Q,{type:"error",description:"Are you sure to delete the Apartment?"})}),l]})}const Ee=M({name:b().required(),description:b(),price_per_month:w().required(),floor_area_size:w().required(),number_of_rooms:w().required()});function Re({onCancel:s,isModalOpen:r,id:t}){const{control:o,handleSubmit:a,formState:{errors:n}}=S({defaultValues:{name:"",description:"",price_per_month:0,floor_area_size:0,number_of_rooms:0},resolver:R(Ee)}),{openNotification:l,contextHolder:i}=A(),[h,u]=y.useState(!1),x=E(),{mutate:m}=Ie({onSuccess(c){s(),x.invalidateQueries(["get-apartments"]),l("The apartment has been updated successfully","success")},onError:()=>{l("Failed to update the apartment","error")}}),d=c=>({name:c.name,description:c.description,price_per_month:parseFloat(c.price_per_month),floor_area_size:parseFloat(c.floor_area_size),number_of_rooms:parseInt(c.number_of_rooms),coordinates:JSON.stringify([130.342,32.3213])}),j=c=>{const g=d(c);Object.keys(g).length!==0&&m(g)};return e.jsxs(e.Fragment,{children:[e.jsxs(q,{title:"Edit the apartment details",style:{height:300},open:r,onOk:a(j),onCancel:s,children:[e.jsxs(p,{layout:"vertical",children:[e.jsx(f,{control:o,rules:{required:!0},render:({field:{onChange:c,onBlur:g,value:_}})=>e.jsxs(p.Item,{label:"Name",children:[e.jsx(N,{value:_,onChange:c,onBlur:g}),n.name&&e.jsx("span",{style:{color:"red"},children:"The Name is required."})]}),name:"name"}),e.jsx(f,{control:o,rules:{required:!0},render:({field:{onChange:c,onBlur:g,value:_}})=>e.jsxs(p.Item,{label:"Price per month",children:[e.jsx(v,{value:_,onChange:c,onBlur:g,prefix:"¥",addonBefore:"+",addonAfter:"$",defaultValue:100}),n.price_per_month&&e.jsx("span",{style:{color:"red"},children:"The price per month is required."})]}),name:"price_per_month"}),e.jsx(f,{control:o,rules:{required:!0},render:({field:{onChange:c,onBlur:g,value:_}})=>e.jsxs(p.Item,{label:"floor area size",children:[e.jsx(v,{value:_,onChange:c,onBlur:g}),n.floor_area_size&&e.jsx("span",{style:{color:"red"},children:"The floor area size is required."})]}),name:"floor_area_size"}),e.jsx(f,{control:o,rules:{required:!0},render:({field:{onChange:c,onBlur:g,value:_}})=>e.jsxs(p.Item,{label:"number of rooms",children:[e.jsx(v,{value:_,onChange:c,onBlur:g}),n.floor_area_size&&e.jsx("span",{style:{color:"red"},children:"The number of rooms is required."})]}),name:"number_of_rooms"}),e.jsx(f,{control:o,rules:{required:!0},render:({field:{onChange:c,onBlur:g,value:_}})=>e.jsxs(p.Item,{label:"Description",children:[e.jsx(V,{rows:4,value:_,onChange:c,onBlur:g}),n.description&&e.jsx("span",{style:{color:"red"},children:"The Description is required."})]}),name:"description"})]}),e.jsx("div",{children:e.jsx(C,{type:"text",onClick:()=>{u(!0)},children:e.jsx(G,{size:20,color:"red"})})})]}),i,h?e.jsx(Te,{currentRowId:t,title:"Delete Apartment",onCancel:()=>{u(!1),s()},isModalOpen:h}):e.jsx(e.Fragment,{})]})}const Me=y.memo(Re),$=()=>{const[s,r]=y.useState("CLIENT");return y.useEffect(()=>{const n=ve();n&&r(n)},[]),{isAdmin:()=>s==="ADMIN",isClient:()=>s==="CLIENT",isRealtor:()=>s==="REALTOR"}},De="https://res.cloudinary.com/homelike/image/upload/w_1900,c_fit,f_auto/homelike-05/uploads/4b4f6f4888bc12223a9e6b31320b9e0e2024d56001f32edf974e813baf3d12d1.jpeg?q=auto";function Le({item:s}){const[r,t]=y.useState(!1),{isClient:o}=$(),{name:a,price_per_month:n,number_of_rooms:l,floor_area_size:i,status:h,id:u}=s;return e.jsxs("div",{style:{width:"280px",margin:"14px",height:"370px",backgroundColor:"white"},children:[e.jsx("div",{className:"apartment-img",style:{width:"100%",height:"50%",backgroundColor:"gray"},children:e.jsx("img",{width:"100%",height:"100%",src:De})}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{children:a}),e.jsxs("div",{className:"mt-8",children:[e.jsxs("div",{className:"flex justify-between items-center",style:{width:"60%"},children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-bold",children:i}),e.jsxs("span",{className:"unit ml-1",children:["ft",e.jsx("sup",{children:"2"})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-bold",children:l}),e.jsx("span",{className:"unit ml-1",children:"rooms"})]})]}),e.jsx(ce,{}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:h?e.jsx("span",{className:"text-green-500",children:"Available"}):e.jsx("span",{className:"text-red-500",children:"Rented"})}),e.jsxs("div",{children:[e.jsxs("span",{className:"font-bold",children:[" £",n]}),e.jsx("span",{className:"unit ml-1",children:"/month"})," "]}),e.jsx("div",{children:!o()&&e.jsx(C,{type:"text",onClick:()=>t(!0),children:e.jsx(Y,{size:20})})})]})]})]}),r?e.jsx(Me,{id:u,onCancel:()=>{t(!1)},isModalOpen:r}):e.jsx(e.Fragment,{})]})}const Oe=M({name:b().required(),description:b(),price_per_month:w().required(),floor_area_size:w().required(),number_of_rooms:w().required()});function Pe({onCancel:s,isModalOpen:r}){const{control:t,handleSubmit:o,formState:{errors:a}}=S({defaultValues:{name:"",description:"",price_per_month:0,floor_area_size:0,number_of_rooms:0},resolver:R(Oe)}),{openNotification:n,contextHolder:l}=A(),i=E(),{mutate:h}=Se({onSuccess(m){s(),i.invalidateQueries(["get-apartments"]),n("The apartment has been added successfully","success")},onError:()=>{n("Failed to add a new apartment","error")}}),u=m=>({name:m.name,description:m.description,price_per_month:parseFloat(m.price_per_month),floor_area_size:parseFloat(m.floor_area_size),number_of_rooms:parseInt(m.number_of_rooms),coordinates:JSON.stringify([130.342,32.3213])}),x=m=>{const d=u(m);Object.keys(d).length!==0&&h(d)};return e.jsxs(e.Fragment,{children:[e.jsx(q,{title:"Add New Apartment",style:{height:500},open:r,onOk:o(x),onCancel:s,children:e.jsxs(p,{layout:"vertical",children:[e.jsx(f,{control:t,rules:{required:!0},render:({field:{onChange:m,onBlur:d,value:j}})=>e.jsxs(p.Item,{label:"Name",children:[e.jsx(N,{value:j,onChange:m,onBlur:d}),a.name&&e.jsx("span",{style:{color:"red"},children:"The Name is required."})]}),name:"name"}),e.jsx(f,{control:t,rules:{required:!0},render:({field:{onChange:m,onBlur:d,value:j}})=>e.jsxs(p.Item,{label:"Price per month",children:[e.jsx(v,{value:j,onChange:m,onBlur:d,prefix:"¥",addonBefore:"+",addonAfter:"$",defaultValue:100}),a.price_per_month&&e.jsx("span",{style:{color:"red"},children:"The price per month is required."})]}),name:"price_per_month"}),e.jsx(f,{control:t,rules:{required:!0},render:({field:{onChange:m,onBlur:d,value:j}})=>e.jsxs(p.Item,{label:"floor area size",children:[e.jsx(v,{value:j,onChange:m,onBlur:d}),a.floor_area_size&&e.jsx("span",{style:{color:"red"},children:"The floor area size is required."})]}),name:"floor_area_size"}),e.jsx(f,{control:t,rules:{required:!0},render:({field:{onChange:m,onBlur:d,value:j}})=>e.jsxs(p.Item,{label:"number of rooms",children:[e.jsx(v,{value:j,onChange:m,onBlur:d}),a.floor_area_size&&e.jsx("span",{style:{color:"red"},children:"The number of rooms is required."})]}),name:"number_of_rooms"}),e.jsx(f,{control:t,rules:{required:!0},render:({field:{onChange:m,onBlur:d,value:j}})=>e.jsxs(p.Item,{label:"Description",children:[e.jsx(V,{rows:4,value:j,onChange:m,onBlur:d}),a.description&&e.jsx("span",{style:{color:"red"},children:"The Description is required."})]}),name:"description"})]})}),l]})}const ze=y.memo(Pe);var Ue={};const $e=Ue.REACT_APP_API_KEY||"";function He(){return e.jsx(xe,{apiKey:$e,children:e.jsx(je,{zoom:3,center:{lat:22.54992,lng:0},gestureHandling:"greedy",disableDefaultUI:!0})})}const Be=y.memo(He),L=({onClick:s,children:r})=>e.jsx(e.Fragment,{children:e.jsx(C,{style:{width:"100%"},onClick:s,children:r})});function Ke({onCancel:s,isModalOpen:r,getFilter:t}){const{control:o,handleSubmit:a,reset:n}=S({defaultValues:{price_per_month:0,floor_area_size:0,number_of_rooms:0}}),l=i=>{t(i),s()};return e.jsx(e.Fragment,{children:e.jsxs(q,{title:"Filter Apartments",style:{height:500},open:r,onOk:a(l),onCancel:s,children:[e.jsxs(p,{layout:"vertical",children:[e.jsx(f,{control:o,rules:{required:!0},render:({field:{onChange:i,onBlur:h,value:u}})=>e.jsx(p.Item,{label:"Price per month",children:e.jsx(v,{value:u,onChange:i,onBlur:h,prefix:"¥",addonBefore:"+",addonAfter:"$",defaultValue:100})}),name:"price_per_month"}),e.jsx(f,{control:o,rules:{required:!0},render:({field:{onChange:i,onBlur:h,value:u}})=>e.jsx(p.Item,{label:"floor area size",children:e.jsx(v,{value:u,onChange:i,onBlur:h})}),name:"floor_area_size"}),e.jsx(f,{control:o,rules:{required:!0},render:({field:{onChange:i,onBlur:h,value:u}})=>e.jsx(p.Item,{label:"number of rooms",children:e.jsx(v,{value:u,onChange:i,onBlur:h})}),name:"number_of_rooms"})]}),e.jsx("div",{children:e.jsx(L,{onClick:()=>{t({}),n()},children:"Reset Filter"})})]})})}function se({titleButton:s,onClick:r}){return e.jsx(e.Fragment,{children:e.jsx("div",{style:{backgroundColor:"white",textAlign:"right"},className:"p-4",children:e.jsx(C,{type:"primary",onClick:r,children:s})})})}function Qe(){const[s,r]=y.useState(!1),[t,o]=y.useState(!1),{isClient:a}=$(),[n,l]=y.useState({take:10}),{data:i,isSuccess:h,isLoading:u}=qe(n),x=m=>{l({...n,...m})};return e.jsxs(e.Fragment,{children:[a()?e.jsx(e.Fragment,{}):e.jsx(se,{titleButton:"Add new Apartment",onClick:()=>r(!0)}),e.jsxs("div",{className:"flex justify-between mt-4 mb-4 p-4",children:[e.jsxs("div",{style:{width:"71%"},children:[e.jsxs("div",{className:"mb-6 flex justify-between",children:[e.jsx("h2",{children:" Furnished Apartments for Rent"}),e.jsx(C,{type:"text",onClick:()=>{o(!0)},children:e.jsx(pe,{size:25})})]}),e.jsx("div",{className:"flex flex-wrap",children:h&&!u?i==null?void 0:i.data.map(m=>e.jsx(Le,{item:m})):e.jsx(e.Fragment,{children:"No Apartments Found"})})]}),e.jsx("div",{style:{width:"25%"},children:e.jsx(Be,{})})]}),s&&e.jsx(ze,{onCancel:()=>{r(!1)},isModalOpen:s}),e.jsx(Ke,{getFilter:x,isModalOpen:t,onCancel:()=>{o(!1)}})]})}const I=()=>{const s=W();return{handleOnLogin:a=>{const{access_token:n,username:l,role:i}=a;n&&(Ae(n),_e(n),Ne(l,i),s("/",{replace:!0}))},handleOnLogout:()=>{be(),s("/login",{replace:!0})},isAuthenticated:()=>!!X()}},Ve=({onSuccess:s,onError:r})=>{const{mutate:t,isError:o,isLoading:a,isSuccess:n,data:l}=F({mutationFn:i=>P("auth/register",i),onSuccess:s,onError:r});return{mutate:t,isError:o,isLoading:a,isSuccess:n,data:l}},Je=({onSuccess:s,onError:r})=>{const{mutate:t,isError:o,isLoading:a,isSuccess:n,data:l}=F({mutationFn:i=>P("auth/login",i),onSuccess:s,onError:r});return{mutate:t,isError:o,isLoading:a,isSuccess:n,data:l}},Ge=M({email:b().required(),password:b()}).required();function Ye(){const{handleOnLogin:s}=I(),{contextHolder:r,openNotification:t}=A(),{mutate:o}=Je({onSuccess:u=>{u.data.access_token&&(s(u.data),t("Successfully logged in ","success"))},onError(u,x,m){t(`unable to logged in, ${u.message}`,"error")}}),{control:a,handleSubmit:n,formState:{errors:l}}=S({defaultValues:{email:"",password:""},resolver:R(Ge)}),i=u=>({email:u.email,password:u.password}),h=u=>{const x=i(u);o(x)};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex justify-center items-center",style:{backgroundColor:"white",height:"70vh"},children:[r,e.jsxs("div",{style:{width:"30%"},children:[e.jsx("h1",{children:"Sign Up"}),e.jsxs(p,{children:[e.jsx(f,{control:a,rules:{required:!0},render:({field:{onChange:u,onBlur:x,value:m}})=>e.jsxs(p.Item,{label:"",className:"mt-6 mb-6",children:[e.jsx(N,{value:m,placeholder:"E-email",onChange:u,onBlur:x}),l.email&&e.jsx("span",{style:{color:"red"},children:"The Email is required."})]}),name:"email"}),e.jsx(f,{control:a,rules:{required:!0},render:({field:{onChange:u,onBlur:x,value:m}})=>e.jsxs(p.Item,{label:"",className:"mt-6 mb-6",children:[e.jsx(N.Password,{value:m,placeholder:"password",onChange:u,onBlur:x}),l.password&&e.jsx("span",{style:{color:"red"},children:"The Password is required."})]}),name:"password"}),e.jsxs("div",{children:[e.jsx(L,{onClick:n(h),children:"Sign Up"}),e.jsxs("div",{className:"p-4 pl-0",children:[e.jsxs("p",{style:{display:"inline-block"},className:"mr-2",children:[" ","Don't have an account ?"]}),e.jsx(k,{to:"/register",children:"Create an account"})]})]})]})]})]})})}const We=y.memo(Ye);var T=(s=>(s.ADMIN="ADMIN",s.CLIENT="CLIENT",s.REALTOR="REALTOR",s))(T||{});const Xe=M({email:b().required(),password:b().required(),username:b().required()}).required();function Ze(){const{handleOnLogin:s}=I(),[r,t]=y.useState(!1),{contextHolder:o,openNotification:a}=A(),{mutate:n}=Ve({onSuccess:d=>{d.data.access_token&&(s(d.data),a("Successfully created a new account","success"))},onError(d,j,c){a(`unable to create a new account, ${d.message}`,"error")}}),{control:l,handleSubmit:i,formState:{errors:h}}=S({defaultValues:{email:"",password:"",username:""},resolver:R(Xe)}),u=d=>({email:d.email,username:d.username,password:d.password,role:r?T.REALTOR:T.CLIENT}),x=d=>{const j=u(d);n(j)},m=d=>{t(d.target.checked)};return e.jsxs("div",{className:"flex justify-center items-center",style:{backgroundColor:"white",height:"70vh"},children:[e.jsxs("div",{style:{width:"30%"},children:[e.jsx("h1",{children:"Create new account"}),e.jsxs(p,{children:[e.jsx(f,{control:l,rules:{required:!0},render:({field:{onChange:d,onBlur:j,value:c}})=>e.jsxs(p.Item,{label:"",className:"mt-6 mb-6",children:[e.jsx(N,{value:c,placeholder:"Username",onChange:d,onBlur:j}),h.username&&e.jsx("span",{style:{color:"red"},children:"The username is required."})]}),name:"username"}),e.jsx("div",{className:"mt-6 mb-6",children:e.jsx(J,{value:r,onChange:m,children:"as Realtor"})}),e.jsx(f,{control:l,rules:{required:!0},render:({field:{onChange:d,onBlur:j,value:c}})=>e.jsxs(p.Item,{label:"",className:"mt-6 mb-6",children:[e.jsx(N,{value:c,placeholder:"E-email",onChange:d,onBlur:j}),h.email&&e.jsx("span",{style:{color:"red"},children:"The Email is required."})]}),name:"email"}),e.jsx(f,{control:l,rules:{required:!0},render:({field:{onChange:d,onBlur:j,value:c}})=>e.jsxs(p.Item,{label:"",className:"mt-6 mb-6",children:[e.jsx(N.Password,{value:c,placeholder:"password",onChange:d,onBlur:j}),h.password&&e.jsx("span",{style:{color:"red"},children:"The Password is required."})]}),name:"password"}),e.jsxs("div",{children:[e.jsx(L,{onClick:i(x),children:"Sign In"}),e.jsxs("div",{className:"p-4 pl-0",children:[e.jsx("p",{style:{display:"inline-block"},className:"mr-2",children:"Do you have an account already ?"}),e.jsx(k,{to:"/login",children:"Sign up"})]})]})]})]}),o]})}const es="_mainHeader_1f18g_2",ss={mainHeader:es};function rs(){const{handleOnLogout:s}=I(),r=[{key:"1",label:e.jsx(L,{onClick:s,children:"Logout"})}];return e.jsx(e.Fragment,{children:e.jsx(de,{menu:{items:r},children:e.jsxs("div",{children:[e.jsx(ue,{shape:"square",size:"large",icon:e.jsx(ge,{})}),e.jsx("span",{className:"font-bold pl-4",children:sessionStorage.getItem("username")?sessionStorage.getItem("username"):"User"})]})})})}const ts=y.memo(rs);function ns(){const[s,r]=y.useState("home"),{isAuthenticated:t}=I(),{isAdmin:o}=$(),a=W(),n=i=>{r(i.key)},l=()=>{a("/register")};return e.jsxs("div",{className:ss.mainHeader,children:[e.jsx("div",{style:{backgroundColor:"black",fontFamily:"fantasy"},children:e.jsx("h1",{style:{color:"white",fontWeight:"bold"},children:"Rental UK"})}),e.jsx("div",{className:"flex justify-between",style:{width:"40%"},children:e.jsx(O,{onClick:n,selectedKeys:[s],mode:"horizontal",inlineCollapsed:!1,children:t()?e.jsxs(e.Fragment,{children:[e.jsx(O.Item,{children:e.jsx(k,{to:"/",children:"Home"})},"home"),o()&&e.jsx(O.Item,{children:e.jsx(k,{to:"/users",children:"Users"})},"users"),e.jsx(O.Item,{children:e.jsx(k,{to:"/apartments",children:"Apartments"})},"apartments")]}):e.jsx(e.Fragment,{})})}),e.jsx("div",{style:{width:"200px flex justify-between"},children:t()?e.jsx(e.Fragment,{children:e.jsx(ts,{})}):e.jsx(L,{onClick:l,children:"Sign in"})})]})}function os(){return e.jsxs(e.Fragment,{children:[e.jsx(ns,{}),e.jsx(fe,{})]})}const as=()=>{const{data:s,isSuccess:r,isLoading:t}=K({queryKey:["get-users"],queryFn:()=>Z("users/list")});return{data:s,isSuccess:r,isLoading:t}},is=({onSuccess:s,onError:r})=>{const{mutate:t,isError:o,isLoading:a,isSuccess:n,data:l}=F({mutationFn:i=>ee(`users/${i}`),onSuccess:s,onError:r});return{mutate:t,isError:o,isLoading:a,isSuccess:n,data:l}},ls=({onSuccess:s,onError:r})=>{const{mutate:t,isError:o,isLoading:a,isSuccess:n,data:l}=F({mutationFn:i=>P("users/new",i),onSuccess:s,onError:r});return{mutate:t,isError:o,isLoading:a,isSuccess:n,data:l}};function cs({onCancel:s,isModalOpen:r,title:t,currentRowId:o}){const a=E(),{openNotification:n,contextHolder:l}=A(),{mutate:i}=is({onSuccess:()=>{n("Deleted user successfully","success"),s(),a.invalidateQueries("get-users")},onError:()=>{n("Failed to deleted the user!","error")}}),h=()=>{i(o)};return e.jsxs(e.Fragment,{children:[e.jsx(q,{title:t,style:{height:300},open:r,onOk:h,onCancel:s,children:e.jsx(Q,{type:"error",description:"Are you sure to delete the user?"})}),l]})}const ds=M({email:b().required(),password:b().required(),username:b().required()}).required();function us({onCancel:s,isModalOpen:r}){const{openNotification:t,contextHolder:o}=A(),a=E(),{mutate:n}=ls({onSuccess(){t("The user has been added successfully","success"),a.invalidateQueries(["get-users"]),s()},onError:()=>{t("Failed to user a new apartment","error")}}),[l,i]=y.useState(!1),{control:h,handleSubmit:u,formState:{errors:x}}=S({defaultValues:{email:"",password:"",username:""},resolver:R(ds)}),m=c=>({email:c.email,username:c.username,password:c.password,role:l?T.REALTOR:T.CLIENT}),d=c=>{const g=m(c);n(g)},j=c=>{i(c.target.checked)};return e.jsxs(e.Fragment,{children:[e.jsx(q,{title:"Add New User",style:{height:500},open:r,onOk:u(d),onCancel:s,children:e.jsxs(p,{children:[e.jsx(f,{control:h,rules:{required:!0},render:({field:{onChange:c,onBlur:g,value:_}})=>e.jsxs(p.Item,{label:"",className:"mt-6 mb-6",children:[e.jsx(N,{value:_,placeholder:"Username",onChange:c,onBlur:g}),x.username&&e.jsx("span",{style:{color:"red"},children:"The username is required."})]}),name:"username"}),e.jsx("div",{className:"mt-6 mb-6",children:e.jsx(J,{value:l,onChange:j,children:"as Realtor"})}),e.jsx(f,{control:h,rules:{required:!0},render:({field:{onChange:c,onBlur:g,value:_}})=>e.jsxs(p.Item,{label:"",className:"mt-6 mb-6",children:[e.jsx(N,{value:_,placeholder:"E-email",onChange:c,onBlur:g}),x.email&&e.jsx("span",{style:{color:"red"},children:"The Email is required."})]}),name:"email"}),e.jsx(f,{control:h,rules:{required:!0},render:({field:{onChange:c,onBlur:g,value:_}})=>e.jsxs(p.Item,{label:"",className:"mt-6 mb-6",children:[e.jsx(N.Password,{value:_,placeholder:"password",onChange:c,onBlur:g}),x.password&&e.jsx("span",{style:{color:"red"},children:"The Password is required."})]}),name:"password"})]})}),o]})}const ms=y.memo(us);function hs(){const{data:s,isLoading:r,isSuccess:t}=as(),[o,a]=y.useState(!1),[n,l]=y.useState(""),[i,h]=y.useState(!1),u=[{title:"Username",dataIndex:"username",key:"username"},{title:"Email",dataIndex:"email",key:"email"},{title:"Role",render:x=>e.jsx(e.Fragment,{children:e.jsx("span",{style:{backgroundColor:"green",color:"white",borderRadius:"20px",display:"inline-block",padding:"5px 10px"},children:x.role})})},{title:"Actions",render:x=>e.jsxs(e.Fragment,{children:[e.jsx(C,{type:"text",children:e.jsx(Y,{size:20})}),e.jsx(C,{type:"text",onClick:()=>{a(!0),l(x.id)},children:e.jsx(G,{size:20,color:"red"})})]})}];return e.jsxs(e.Fragment,{children:[e.jsx(se,{titleButton:"Add new user",onClick:()=>h(!0)}),e.jsxs("div",{className:"p-4",children:[e.jsx("h1",{className:"m-4",children:"Users"}),e.jsx("div",{children:e.jsx(me,{dataSource:t?s==null?void 0:s.data:[],loading:r,columns:u})}),e.jsx(cs,{currentRowId:n,title:"Delete User",onCancel:()=>{a(!1)},isModalOpen:o})]}),i&&e.jsx(ms,{onCancel:()=>{h(!1)},isModalOpen:i})]})}const H=({children:s})=>{const{isAuthenticated:r}=I();return r()?e.jsx(e.Fragment,{children:s}):e.jsx(z,{to:"/login"})},B=({children:s})=>{const{isAuthenticated:r}=I();return r()?e.jsx(z,{to:"/"}):e.jsx(e.Fragment,{children:s})},ps=ae([{path:"/",element:e.jsx(z,{to:"/apartments"})},{path:"/",element:e.jsx(os,{}),children:[{path:"apartments",element:e.jsx(H,{children:e.jsx(Qe,{})})},{path:"users",element:e.jsx(H,{children:e.jsx(hs,{})})},{path:"login",element:e.jsx(B,{children:e.jsx(We,{})})},{path:"register",element:e.jsx(B,{children:e.jsx(Ze,{})})}]}]);function xs(){const s=new ne;return e.jsxs(oe,{client:s,children:[e.jsx(ie,{router:ps}),";"]})}const js=te.createRoot(document.getElementById("root"));js.render(e.jsx(re.StrictMode,{children:e.jsx(xs,{})}));
