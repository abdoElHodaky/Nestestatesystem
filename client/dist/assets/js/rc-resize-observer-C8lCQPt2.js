import{i as N,j as L,a as $,_ as j,e as M,g as A}from"./@babel-Ci6hP7BZ.js";import{r as t}from"./react-BARQyoEZ.js";import{s as F,k as J,J as I,y as K}from"./rc-util-CIqK80OI.js";import{i as T}from"./resize-observer-polyfill-B1PUzC5B.js";var c=new Map;function V(e){e.forEach(function(i){var r,o=i.target;(r=c.get(o))===null||r===void 0||r.forEach(function(n){return n(o)})})}var O=new T(V);function X(e,i){c.has(e)||(c.set(e,new Set),O.observe(e)),c.get(e).add(i)}function Y(e,i){c.has(e)&&(c.get(e).delete(i),c.get(e).size||(O.unobserve(e),c.delete(e)))}var q=function(e){N(r,e);var i=L(r);function r(){return $(this,r),i.apply(this,arguments)}return j(r,[{key:"render",value:function(){return this.props.children}}]),r}(t.Component),m=t.createContext(null);function G(e){var i=e.children,r=e.onBatchResize,o=t.useRef(0),n=t.useRef([]),a=t.useContext(m),v=t.useCallback(function(l,f,u){o.current+=1;var d=o.current;n.current.push({size:l,element:f,data:u}),Promise.resolve().then(function(){d===o.current&&(r==null||r(n.current),n.current=[])}),a==null||a(l,f,u)},[r,a]);return t.createElement(m.Provider,{value:v},i)}function Q(e,i){var r=e.children,o=e.disabled,n=t.useRef(null),a=t.useRef(null),v=t.useContext(m),l=typeof r=="function",f=l?r(n):r,u=t.useRef({width:-1,height:-1,offsetWidth:-1,offsetHeight:-1}),d=!l&&t.isValidElement(f)&&F(f),C=d?f.ref:null,D=t.useMemo(function(){return J(C,n)},[C,n]),b=function(){return I(n.current)||I(a.current)};t.useImperativeHandle(i,function(){return b()});var z=t.useRef(e);z.current=e;var E=t.useCallback(function(s){var _=z.current,w=_.onResize,P=_.data,x=s.getBoundingClientRect(),g=x.width,p=x.height,h=s.offsetWidth,R=s.offsetHeight,y=Math.floor(g),k=Math.floor(p);if(u.current.width!==y||u.current.height!==k||u.current.offsetWidth!==h||u.current.offsetHeight!==R){var W={width:y,height:k,offsetWidth:h,offsetHeight:R};u.current=W;var S=h===Math.round(g)?g:h,B=R===Math.round(p)?p:R,H=M(M({},W),{},{offsetWidth:S,offsetHeight:B});v==null||v(H,s,P),w&&Promise.resolve().then(function(){w(H,s)})}},[]);return t.useEffect(function(){var s=b();return s&&!o&&X(s,E),function(){return Y(s,E)}},[n.current,o]),t.createElement(q,{ref:a},d?t.cloneElement(f,{ref:D}):f)}var U=t.forwardRef(Q),Z="rc-observer-key";function ee(e,i){var r=e.children,o=typeof r=="function"?[r]:K(r);return o.map(function(n,a){var v=(n==null?void 0:n.key)||"".concat(Z,"-").concat(a);return t.createElement(U,A({},e,{key:v,ref:a===0?i:void 0}),n)})}var re=t.forwardRef(ee);re.Collection=G;export{re as R};
