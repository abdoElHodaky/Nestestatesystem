import{c as H,g as $,b as ee,d as he,e as O,f as j,h as ke}from"./@babel-Ci6hP7BZ.js";import{r as i,a as G}from"./react-Ca33GWNH.js";import{r as Ee}from"./react-dom-tzxqXf6b.js";import{c as q}from"./classnames-0Dw0RLG4.js";import{a as xe}from"./rc-motion-D_l6tXtc.js";import{K as Se}from"./rc-util-DmFw392k.js";var Re=i.forwardRef(function(e,r){var l=e.prefixCls,f=e.style,s=e.className,u=e.duration,y=u===void 0?4.5:u,b=e.eventKey,R=e.content,L=e.closable,p=e.closeIcon,P=p===void 0?"x":p,d=e.props,C=e.onClick,v=e.onNoticeClose,M=e.times,h=e.hovering,m=i.useState(!1),_=H(m,2),x=_[0],k=_[1],N=h||x,E=function(){v(b)},c=function(t){(t.key==="Enter"||t.code==="Enter"||t.keyCode===Se.ENTER)&&E()};i.useEffect(function(){if(!N&&y>0){var n=setTimeout(function(){E()},y*1e3);return function(){clearTimeout(n)}}},[y,N,M]);var o="".concat(l,"-notice");return i.createElement("div",$({},d,{ref:r,className:q(o,s,ee({},"".concat(o,"-closable"),L)),style:f,onMouseEnter:function(t){var a;k(!0),d==null||(a=d.onMouseEnter)===null||a===void 0||a.call(d,t)},onMouseLeave:function(t){var a;k(!1),d==null||(a=d.onMouseLeave)===null||a===void 0||a.call(d,t)},onClick:C}),i.createElement("div",{className:"".concat(o,"-content")},R),L&&i.createElement("a",{tabIndex:0,className:"".concat(o,"-close"),onKeyDown:c,onClick:function(t){t.preventDefault(),t.stopPropagation(),E()}},P))}),le=G.createContext({}),we=function(r){var l=r.children,f=r.classNames;return G.createElement(le.Provider,{value:{classNames:f}},l)},re=8,ie=3,ce=16,Ae=function(r){var l={offset:re,threshold:ie,gap:ce};if(r&&he(r)==="object"){var f,s,u;l.offset=(f=r.offset)!==null&&f!==void 0?f:re,l.threshold=(s=r.threshold)!==null&&s!==void 0?s:ie,l.gap=(u=r.gap)!==null&&u!==void 0?u:ce}return[!!r,l]},Le=function(r){var l,f=r.configList,s=r.placement,u=r.prefixCls,y=r.className,b=r.style,R=r.motion,L=r.onAllNoticeRemoved,p=r.onNoticeClose,P=r.stack,d=i.useContext(le),C=d.classNames,v=i.useRef({}),M=i.useState(null),h=H(M,2),m=h[0],_=h[1],x=i.useState([]),k=H(x,2),N=k[0],E=k[1],c=f.map(function(g){return{config:g,key:g.key}}),o=Ae(P),n=H(o,2),t=n[0],a=n[1],S=a.offset,K=a.threshold,w=a.gap,D=t&&(N.length>0||c.length<=K),ue=typeof R=="function"?R(s):R;return i.useEffect(function(){t&&N.length>1&&E(function(g){return g.filter(function(I){return c.some(function(F){var z=F.key;return I===z})})})},[N,c,t]),i.useEffect(function(){var g;if(t&&v.current[(g=c[c.length-1])===null||g===void 0?void 0:g.key]){var I;_(v.current[(I=c[c.length-1])===null||I===void 0?void 0:I.key])}},[c,t]),G.createElement(xe,$({key:s,className:q(u,"".concat(u,"-").concat(s),C==null?void 0:C.list,y,(l={},ee(l,"".concat(u,"-stack"),!!t),ee(l,"".concat(u,"-stack-expanded"),D),l)),style:b,keys:c,motionAppear:!0},ue,{onAllRemoved:function(){L(s)}}),function(g,I){var F=g.config,z=g.className,fe=g.style,ve=g.index,te=F,A=te.key,de=te.times,ne=F,me=ne.className,ye=ne.style,B=c.findIndex(function(Q){return Q.key===A}),U={};if(t){var W=c.length-1-(B>-1?B:ve-1),oe=s==="top"||s==="bottom"?"-50%":"0";if(W>0){var J,V,X;U.height=D?(J=v.current[A])===null||J===void 0?void 0:J.offsetHeight:m==null?void 0:m.offsetHeight;for(var ae=0,Y=0;Y<W;Y++){var Z;ae+=((Z=v.current[c[c.length-1-Y].key])===null||Z===void 0?void 0:Z.offsetHeight)+w}var Ce=(D?ae:W*S)*(s.startsWith("top")?1:-1),Ne=!D&&m!==null&&m!==void 0&&m.offsetWidth&&(V=v.current[A])!==null&&V!==void 0&&V.offsetWidth?((m==null?void 0:m.offsetWidth)-S*2*(W<3?W:3))/((X=v.current[A])===null||X===void 0?void 0:X.offsetWidth):1;U.transform="translate3d(".concat(oe,", ").concat(Ce,"px, 0) scaleX(").concat(Ne,")")}else U.transform="translate3d(".concat(oe,", 0, 0)")}return G.createElement("div",{ref:I,className:q("".concat(u,"-notice-wrapper"),z),style:O(O(O({},fe),U),ye),onMouseEnter:function(){return E(function(T){return T.includes(A)?T:[].concat(j(T),[A])})},onMouseLeave:function(){return E(function(T){return T.filter(function(ge){return ge!==A})})}},G.createElement(Re,$({},F,{ref:function(T){B>-1?v.current[A]=T:delete v.current[A]},prefixCls:u,className:q(me,C==null?void 0:C.notice),times:de,key:A,eventKey:A,onNoticeClose:p,hovering:t&&N.length>0})))})},be=i.forwardRef(function(e,r){var l=e.prefixCls,f=l===void 0?"rc-notification":l,s=e.container,u=e.motion,y=e.maxCount,b=e.className,R=e.style,L=e.onAllRemoved,p=e.stack,P=e.renderNotifications,d=i.useState([]),C=H(d,2),v=C[0],M=C[1],h=function(n){var t,a=v.find(function(S){return S.key===n});a==null||(t=a.onClose)===null||t===void 0||t.call(a),M(function(S){return S.filter(function(K){return K.key!==n})})};i.useImperativeHandle(r,function(){return{open:function(n){M(function(t){var a=j(t),S=a.findIndex(function(D){return D.key===n.key}),K=O({},n);if(S>=0){var w;K.times=(((w=t[S])===null||w===void 0?void 0:w.times)||0)+1,a[S]=K}else K.times=0,a.push(K);return y>0&&a.length>y&&(a=a.slice(-y)),a})},close:function(n){h(n)},destroy:function(){M([])}}});var m=i.useState({}),_=H(m,2),x=_[0],k=_[1];i.useEffect(function(){var o={};v.forEach(function(n){var t=n.placement,a=t===void 0?"topRight":t;a&&(o[a]=o[a]||[],o[a].push(n))}),Object.keys(x).forEach(function(n){o[n]=o[n]||[]}),k(o)},[v]);var N=function(n){k(function(t){var a=O({},t),S=a[n]||[];return S.length||delete a[n],a})},E=i.useRef(!1);if(i.useEffect(function(){Object.keys(x).length>0?E.current=!0:E.current&&(L==null||L(),E.current=!1)},[x]),!s)return null;var c=Object.keys(x);return Ee.createPortal(i.createElement(i.Fragment,null,c.map(function(o){var n=x[o],t=i.createElement(Le,{key:o,configList:n,placement:o,prefixCls:f,className:b==null?void 0:b(o),style:R==null?void 0:R(o),motion:u,onNoticeClose:h,onAllNoticeRemoved:N,stack:p});return P?P(t,{prefixCls:f,key:o}):t})),s)}),Me=["getContainer","motion","prefixCls","maxCount","className","style","onAllRemoved","stack","renderNotifications"],_e=function(){return document.body},se=0;function pe(){for(var e={},r=arguments.length,l=new Array(r),f=0;f<r;f++)l[f]=arguments[f];return l.forEach(function(s){s&&Object.keys(s).forEach(function(u){var y=s[u];y!==void 0&&(e[u]=y)})}),e}function Fe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.getContainer,l=r===void 0?_e:r,f=e.motion,s=e.prefixCls,u=e.maxCount,y=e.className,b=e.style,R=e.onAllRemoved,L=e.stack,p=e.renderNotifications,P=ke(e,Me),d=i.useState(),C=H(d,2),v=C[0],M=C[1],h=i.useRef(),m=i.createElement(be,{container:v,ref:h,prefixCls:s,motion:f,maxCount:u,className:y,style:b,onAllRemoved:R,stack:L,renderNotifications:p}),_=i.useState([]),x=H(_,2),k=x[0],N=x[1],E=i.useMemo(function(){return{open:function(o){var n=pe(P,o);(n.key===null||n.key===void 0)&&(n.key="rc-notification-".concat(se),se+=1),N(function(t){return[].concat(j(t),[{type:"open",config:n}])})},close:function(o){N(function(n){return[].concat(j(n),[{type:"close",key:o}])})},destroy:function(){N(function(o){return[].concat(j(o),[{type:"destroy"}])})}}},[]);return i.useEffect(function(){M(l())}),i.useEffect(function(){h.current&&k.length&&(k.forEach(function(c){switch(c.type){case"open":h.current.open(c.config);break;case"close":h.current.close(c.key);break;case"destroy":h.current.destroy();break}}),N(function(c){return c.filter(function(o){return!k.includes(o)})}))},[k]),[E,m]}export{Re as N,we as a,Fe as u};
